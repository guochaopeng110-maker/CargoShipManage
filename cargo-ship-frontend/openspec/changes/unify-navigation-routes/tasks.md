# 实施任务清单 (Implementation Tasks)

本文档列出了统一导航结构与路由配置变更的具体实施步骤。任务按执行顺序排列，每个任务都应独立验证后再进行下一步。

## 1. 准备阶段

- [x] 1.1 审查当前 Sidebar 导航结构和 MainLayout 路由配置
  - 详细对比当前实现与 `frontend_refactoring_plan.md` 的差异
  - 列出需要添加、修改、移除的导航项和路由
  - 确认所有页面组件的存在性和实现状态

- [x] 1.2 确认需要创建或修改的页面组件
  - 检查 `PowerDistributionPage.tsx` 是否存在，不存在则标记为需创建
  - 检查 `RoleManagementPage.tsx` 是否存在，不存在则标记为需创建
  - 确认"视情维护"和"辅助决策"页面的当前UI实现状态

## 2. 核心实现

- [x] 2.1 创建统一导航配置模块 (`src/config/navigation.ts`)
  - 定义 `NavItem` 接口，包含所有必要的导航元数据
  - 定义 `navigationConfig` 常量，包含完整的导航树结构
  - 按照重构计划的导航层级组织配置数据
  - 为每个导航项添加开发状态标识（如 `needsBackend` 字段）
  - 添加类型安全的辅助函数（如 `getAllRoutes()`, `getNavigationTree()` 等）
  - 添加清晰的注释，说明每个菜单组和页面的用途及开发状态

- [x] 2.2 创建缺失的页面组件（如需要）
  - 如果 `PowerDistributionPage.tsx` 不存在，创建占位页面
  - 如果 `RoleManagementPage.tsx` 不存在，创建占位页面
  - 确保新创建的页面组件遵循现有的设计风格和布局模式

- [x] 2.3 重构 Sidebar 组件 (`src/components/Sidebar.tsx`)
  - 导入 `navigation.ts` 中的导航配置
  - 移除组件内部硬编码的 `navigationItems` 数组
  - 使用配置中的数据渲染导航菜单
  - 确保所有现有交互功能（展开/收起、悬停、高亮等）正常工作
  - 保持视觉样式和动画效果不变

- [x] 2.4 重构 MainLayout 路由配置 (`src/components/MainLayout.tsx`)
  - 导入 `navigation.ts` 中的导航配置
  - 使用配置数据动态生成 `<Route>` 组件
  - 确保每个导航项都有对应的路由
  - 处理嵌套路由（如菜单组）的路径映射
  - 移除不在重构计划范围内的路由（如 `AlertThresholdPage`, `EquipmentHealthPage`, `ReportsPage`）
  - 添加缺失的路由（如 `PowerDistributionPage`, `RoleManagementPage`）
  - 确保默认路由（`/`）正确重定向到 `/dashboard`
  - 确保未匹配路由（`*`）的处理逻辑合理

## 3. 验证与测试

- [x] 3.1 功能验证
  - 手动测试所有导航菜单项的点击跳转
  - 验证所有路由都能正确加载对应的页面组件
  - 验证嵌套菜单（菜单组）的展开/收起功能
  - 验证当前页面在导航菜单中的高亮显示
  - 验证浏览器前进/后退按钮的导航功能
  - 验证直接输入URL访问页面的功能

- [x] 3.2 TypeScript 类型检查
  - 运行 `npm run type-check` 或 `tsc --noEmit`
  - 修复所有类型错误
  - 确保导航配置的类型安全性

- [x] 3.3 构建验证
  - 运行 `npm run build`
  - 确保构建过程无错误和警告
  - 检查构建产物的大小是否合理

- [x] 3.4 代码质量检查
  - 运行 `npm run lint` 确保代码符合项目规范
  - 确保所有新增代码都有适当的注释
  - 确保导航配置文件的可读性和可维护性

## 4. 清理与文档

- [x] 4.1 移除不需要的代码和文件
  - 移除 `AlertThresholdPage.tsx`（如不在重构范围内）
  - 移除 `EquipmentHealthPage.tsx`（如不在重构范围内）
  - 移除 `ReportsPage.tsx`（如不在重构范围内）
  - 清理未使用的导入和类型定义
  - 清理组件中的冗余代码和注释

- [x] 4.2 更新文档和注释
  - 在导航配置文件中添加清晰的使用说明
  - 更新相关组件的注释，说明其如何使用导航配置
  - 确保配置中的注释准确反映当前开发状态

- [x] 4.3 最终审查
  - 再次对比代码实现与 `frontend_refactoring_plan.md`，确保完全一致
  - 检查所有成功标准是否满足
  - 准备变更说明文档供团队审查

## 5. 部署准备

- [ ] 5.1 创建提交和PR
  - 创建有意义的 git commit message
  - 整理变更说明，包括：
    - 变更的导航结构对比
    - 添加/修改/移除的路由列表
    - 潜在的影响和迁移建议
  - 创建 Pull Request，等待代码审查

- [ ] 5.2 团队沟通
  - 向团队成员说明新的导航结构
  - 提醒可能受影响的功能或测试用例
  - 更新相关的开发文档和培训材料

## 依赖关系说明

- 任务 2.2（创建缺失的页面组件）依赖于任务 1.2（确认需要创建的组件）
- 任务 2.3 和 2.4（重构 Sidebar 和 MainLayout）依赖于任务 2.1（创建导航配置模块）
- 任务 3.x（验证与测试）依赖于任务 2.x（核心实现）的完成
- 任务 4.x（清理与文档）依赖于任务 3.x（验证与测试）的完成

## 可并行执行的任务

- 任务 2.2（创建页面组件）和任务 2.1（创建导航配置）可以并行进行
- 任务 3.2、3.3、3.4（类型检查、构建验证、代码质量检查）可以并行进行

## 风险提示

⚠️ **路由变更风险**：修改路由路径可能影响现有的浏览器书签或外部链接
⚠️ **页面移除风险**：移除的页面如果有其他地方引用，可能导致运行时错误
⚠️ **类型安全**：确保导航配置的类型定义严格，避免运行时错误

## 回滚计划

如果变更出现问题，可以通过以下步骤回滚：
1. 恢复 `Sidebar.tsx` 和 `MainLayout.tsx` 的原始版本
2. 删除 `src/config/navigation.ts` 文件
3. 恢复已移除的页面组件文件
4. 运行测试确保应用恢复正常
