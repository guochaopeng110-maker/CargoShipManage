# 健康报告业务逻辑说明

本文档详细说明了船舶设备健康评估报告的核心业务逻辑，旨在为前端展示和后端实现提供统一的依据。

---

## 1. 报告核心内容

每份生成的健康报告应至少包含以下几个方面的数据和分析：

*   **设备基础信息**:
    *   报告对应的设备名称和ID。
    *   生成报告时所选定的时间周期（开始日期与结束日期）。

*   **核心健康评分**:
    *   一个范围在 0-100 之间的综合健康得分，作为设备当前健康状况的量化体现。

*   **告警统计分析**:
    *   在指定时间周期内，不同告警等级（如 P0-紧急, P1-重要, P2-次要）的告警事件发生总次数。
    *   与上一个周期（例如，若本周期为一个月，则与上一个月）的告警次数进行对比，分析告警趋势是增加、减少还是持平。

*   **关键指标分析**:
    *   针对设备的核心性能指标（如负载率、电压、温度等），提供其在该时间周期内的平均值、最大值和最小值。
    *   （可选）能效分析：如果适用，报告可包含设备能效与上一个周期的对比。

*   **诊断与建议**:
    *   基于健康评分和各项分析数据，系统自动生成几条具有可操作性的“优化建议”文本。

---

## 2. 健康评分计算逻辑

健康评分的计算逻辑旨在综合评估设备的运行稳定性和可靠性。基础计算规则如下：

*   **基础分**: 每台设备初始拥有一个较高的基础分，例如 **90分**。

*   **扣分项**:
    *   **严重告警 (P0)**: 发生一次 **P0** 级（紧急）告警，直接将分数置为一个较低值（例如 **40分**），或根据其严重性大幅扣分，表明设备存在重大问题。
    *   **重要告警 (P1)**: 每发生一次 **P1** 级（重要）告警，扣除 **5分**。
    *   **关键指标异常**: 如果关键指标（如温度、振动）的波动性超过预设阈值，根据超出的程度扣除 **2-10分**。

*   **加分项 (可选)**:
    *   若整个周期内无任何告警发生，且所有关键指标均在理想范围内，可额外奖励 **5-10分**，最终得分最高不超过100分。

**最终得分 = 基础分 - 各项扣分 + 各项加分**

---

## 3. 报告输出形式

后端在完成健康报告分析后，前端应以清晰、直观的方式呈现给用户。

*   **主要输出**:
    1.  **健康评分 (Health Score)**: 一个 0 到 100 的数值，应在页面显著位置通过仪表盘（Gauge Chart）或分数卡片的形式展示。
    2.  **优化建议 (Suggestions)**: 一个包含多条建议的文本列表。例如：
        *   "建议检查冷却系统，近期温度有上升趋势。"
        *   "P1级告警频次增加，请安排设备巡检。"
        *   "设备运行稳定，请继续保持常规维护。"

*   **辅助图表**:
    *   使用条形图展示不同等级的**告警次数统计**。
    *   使用折线图或面积图展示关键指标在周期内的**历史趋势**。
    *   使用卡片或列表展示周期内关键指标的**最值和均值**。
